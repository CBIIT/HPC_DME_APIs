<?xml version="1.0" encoding="UTF-8"?>
<!--  
 * hpc-ws-rs-authentication-context.xml
 *
 * Copyright SVG,  Inc.
 * Copyright Leidos Biomedical Research, Inc
 * 
 * Distributed under the OSI-approved BSD 3-Clause License.
 * See http://ncip.github.com/HPC/LICENSE.txt for details.
 *
 * @author <a href="mailto:eran.rosenberg@nih.gov">Eran Rosenberg</a>
 * @version $Id$
 -->

<beans xmlns="http://www.springframework.org/schema/beans" 
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
       xmlns:jaxrs="http://cxf.apache.org/jaxrs" 
       xmlns:aop="http://www.springframework.org/schema/aop" 
       xmlns:security="http://www.springframework.org/schema/security" 
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd 
                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd 
                           http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd 
                           http://cxf.apache.org/jaxrs http://cxf.apache.org/schemas/jaxrs.xsd">

	<!--  
	<security:global-method-security>
		<security:protect-pointcut expression="execution(* gov.nih.nci.hpc.ws.rs.HpcUserRestService.registerUser(*))" access="ROLE_ADMIN"/>
	</security:global-method-security>
    -->
    
    
    <security:http>
        <security:http-basic/>
    </security:http>
    
    <bean id="hpcUserDetailsService"
          class="gov.nih.nci.hpc.ws.rs.impl.HpcUserDetailsServiceImpl"/>
    
    <!--  
	<security:authentication-manager alias="org.springframework.security.config.authentication.AuthenticationManagerFactoryBean#0">
        <security:authentication-provider user-service-ref="hpcUserDetailsService" />
    </security:authentication-manager>
	-->
	<security:authentication-manager alias="org.springframework.security.config.authentication.AuthenticationManagerFactoryBean#0">
    <security:authentication-provider>
        <security:user-service>
            <security:user name="bob" password="***REMOVED***" authorities="ROLE_CUSTOMER"/>
            <security:user name="fred" password="***REMOVED***" authorities="ROLE_CUSTOMER, ROLE_ADMIN"/>
        </security:user-service>
    </security:authentication-provider>
	</security:authentication-manager>
    
</beans>

