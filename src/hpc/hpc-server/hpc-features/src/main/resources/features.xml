<?xml version="1.0"?>
<!--  
 * HpcFeatures.xml
 *
 * Copyright SVG,  Inc.
 * Copyright Leidos Biomedical Research, Inc
 * 
 * Distributed under the OSI-approved BSD 3-Clause License.
 * See http://ncip.github.com/HPC/LICENSE.txt for details.
 *
 * @author <a href="mailto:eran.rosenberg@nih.gov">Eran Rosenberg</a>
 * @version $Id$
 -->
<features name="HPC-${project.version}" xmlns="http://karaf.apache.org/xmlns/features/v1.0.0">

	<!-- PostgreSQL driver -->
	<feature name="hpc-postgresql-driver" version="${postgresql.version}">
		<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.postgresql/${postgresql.version}_1</bundle>
		<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-dbcp/1.4_3</bundle>
	</feature>
	
	<!-- Spring Security LDAP -->
	<feature name="hpc-spring-security-ldap" version="${spring-security.version}">
		<feature version="${spring-security.version}">spring-security</feature>
		<bundle>mvn:org.springframework.security/spring-security-config/${spring-security.version}</bundle>
		<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.spring-jdbc/3.2.11.RELEASE_2</bundle>
		<bundle>mvn:org.springframework.data/spring-data-commons-core/1.4.1.RELEASE</bundle>
		<bundle>mvn:org.springframework.batch/spring-batch-core/2.2.7.RELEASE</bundle>
		<bundle>mvn:org.springframework.batch/spring-batch-infrastructure/2.2.7.RELEASE</bundle>
		<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.spring-ldap/1.3.1.RELEASE_3</bundle>
		<bundle>mvn:org.springframework.security/spring-security-ldap/${spring-security.version}</bundle>
	</feature>
	
	<!-- Amazon AWS SDK -->
	<feature name="hpc-amazon-aws-sdk" version="${amazon-aws.version}">
		<bundle>mvn:com.fasterxml.jackson.core/jackson-core/${jackson.version}</bundle>
		<bundle>mvn:com.fasterxml.jackson.core/jackson-databind/${jackson.version}</bundle>
		<bundle>mvn:com.fasterxml.jackson.core/jackson-annotations/${jackson.version}</bundle>
		<bundle>mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.aws-java-sdk/${amazon-aws.version}_1</bundle>
	</feature>
	
	<!-- iRODs Jargon SDK -->
	<feature name="hpc-jargon-sdk" version="${jargon.version}">
		<bundle>wrap:mvn:org.irods.jargon/jargon-core/${jargon.version}</bundle>
		<bundle>wrap:mvn:org.irods.jargon/jargon-data-utils/${jargon.version}</bundle>
		<bundle>wrap:mvn:org.irods.jargon/jargon-conveyor/${jargon-conveyor.version}</bundle>
		<bundle>wrap:mvn:org.irods.jargon/jargon-user-tagging/${jargon.version}</bundle>
	</feature>
	
	<!-- HPC Server -->
	<feature name="hpc-server" version="${project.version}">
	
		<!--  Dependent Features / Bundles -->
		<feature version="${postgresql.version}">hpc-postgresql-driver</feature>
		<feature version="${spring-security.version}">hpc-spring-security-ldap</feature>
		<feature version="${amazon-aws.version}">hpc-amazon-aws-sdk</feature>
		<feature version="${jargon.version}">hpc-jargon-sdk</feature>
		<bundle>wrap:mvn:com.googlecode.json-simple/json-simple/${google-json-simple.version}</bundle>
		
		
		<!-- Config files -->
		<configfile finalname="/etc/gov.nih.nci.hpc.cfg" override="false">mvn:${project.groupId}/hpc-features/${project.version}/properties/hpc-server</configfile>
		<configfile finalname="/etc/hpc-server/keystore.jks" override="true">mvn:${project.groupId}/hpc-ws-rs-impl/${project.version}/jks/keystore</configfile>
		<configfile finalname="/etc/hpc-server/metadataValidationRules.json" override="true">mvn:${project.groupId}/hpc-app-service-impl/${project.version}/json/metadataValidationRules</configfile>

		<!-- Server Bundles -->
		<bundle>mvn:${project.groupId}/hpc-common/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-domain-types/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-domain-model/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-dto/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-dao-api/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-dao-impl/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-integration-api/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-integration-impl/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-app-service-api/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-app-service-impl/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-bus-service-api/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-bus-service-impl/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-ws-rs-api/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-ws-rs-impl/${project.version}</bundle>
		<bundle>mvn:${project.groupId}/hpc-scheduler/${project.version}</bundle>

	</feature>

</features>
