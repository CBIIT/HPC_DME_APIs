CREATE TABLE "IRODS"."HPC_BULK_DATA_OBJECT_REGISTRATION_RESULT"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   USER_ID VARCHAR2(50) NOT NULL,
   RESULT char(1) NOT NULL,
   MESSAGE VARCHAR2(4000),
   ITEMS CLOB,
   CREATED timestamp NOT NULL,
   COMPLETED timestamp NOT NULL,
   EFFECTIVE_TRANSFER_SPEED number(10)
)
;

CREATE TABLE "IRODS"."HPC_BULK_DATA_OBJECT_REGISTRATION_TASK"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   USER_ID VARCHAR2(50),
   STATUS VARCHAR2(50),
   ITEMS CLOB,
   CREATED timestamp,
   UI_URL VARCHAR2(2000)
)
;

CREATE TABLE "IRODS"."HPC_CATALOG_ATTRIBUTE"
(
   level_label VARCHAR2(50) NOT NULL,
   meta_attr_name VARCHAR2(250) NOT NULL,
   CONSTRAINT HPC_CATALOG_ATTRIBUTE_pkey PRIMARY KEY (level_label,meta_attr_name)
)
;

CREATE TABLE "IRODS"."HPC_COLLECTION_DOWNLOAD_TASK"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   USER_ID VARCHAR(50),
   TYPE VARCHAR(50) NOT NULL,
   PATH VARCHAR2(2700),
   CONFIGURATION_ID VARCHAR2(50),
   DATA_OBJECT_PATHS CLOB,
   DESTINATION_LOCATION_FILE_CONTAINER_ID VARCHAR2(50),
   DESTINATION_LOCATION_FILE_ID VARCHAR2(2700),
   DESTINATION_OVERWRITE char(1),
   S3_ACCOUNT_ACCESS_KEY blob,
   S3_ACCOUNT_SECRET_KEY blob,
   S3_ACCOUNT_REGION VARCHAR2(50),
   STATUS VARCHAR2(50),
   ITEMS CLOB,
   CREATED timestamp,
   PRIORITY number(10) DEFAULT 100,
   COLLECTION_PATHS CLOB,
   APPEND_PATH_TO_DOWNLOAD_DESTINATION char(1),
   CANCELLATION_REQUESTED char(1),
   GOOGLE_DRIVE_ACCESS_TOKEN blob,
   IN_PROCESS char(1) DEFAULT '0' NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_DATA_MANAGEMENT_AUDIT"
(
   USER_ID VARCHAR2(50) NOT NULL,
   PATH VARCHAR2(2000) NOT NULL,
   REQUEST_TYPE VARCHAR2(50) NOT NULL,
   METADATA_BEFORE CLOB NOT NULL,
   METADATA_AFTER CLOB,
   ARCHIVE_FILE_CONTAINER_ID VARCHAR2(200),
   ARCHIVE_FILE_ID VARCHAR2(2700),
   DATA_MANAGEMENT_STATUS char(1) NOT NULL,
   DATA_TRANSFER_STATUS char(1),
   MESSAGE VARCHAR2(2700),
   COMPLETED timestamp NOT NULL
)
;


CREATE TABLE "IRODS"."HPC_DATA_MANAGEMENT_CONFIGURATION"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   BASE_PATH VARCHAR2(50) NOT NULL,
   DOC VARCHAR2(50) NOT NULL,
   DATA_HIERARCHY CLOB,
   COLLECTION_METADATA_VALIDATION_RULES CLOB,
   DATA_OBJECT_METADATA_VALIDATION_RULES CLOB,
   GLOBUS_URL VARCHAR2(2700) NOT NULL,
   GLOBUS_ARCHIVE_ENDPOINT VARCHAR2(2700) NOT NULL,
   GLOBUS_ARCHIVE_PATH VARCHAR2(2700) NOT NULL,
   GLOBUS_ARCHIVE_DIRECTORY VARCHAR2(2700) NOT NULL,
   GLOBUS_ARCHIVE_TYPE VARCHAR2(50) NOT NULL,
   GLOBUS_DOWNLOAD_ENDPOINT VARCHAR2(2700),
   GLOBUS_DOWNLOAD_PATH VARCHAR2(2700),
   GLOBUS_DOWNLOAD_DIRECTORY VARCHAR2(2700),
   S3_UPLOAD_ARCHIVE_CONFIGURATION_ID VARCHAR2(50),
   S3_DEFAULT_DOWNLOAD_ARCHIVE_CONFIGURATION_ID VARCHAR2(50)
)
;


create table HPC_DATA_OBJECT_DOWNLOAD_TASK
(
    ID                                     VARCHAR2(50)           not null
        primary key,
    USER_ID                                VARCHAR2(50),
    PATH                                   VARCHAR2(2700),
    CONFIGURATION_ID                       VARCHAR2(50),
    DATA_TRANSFER_REQUEST_ID               VARCHAR2(50),
    DATA_TRANSFER_TYPE                     VARCHAR2(50),
    DATA_TRANSFER_STATUS                   VARCHAR2(50),
    DOWNLOAD_FILE_PATH                     VARCHAR2(2700),
    ARCHIVE_LOCATION_FILE_CONTAINER_ID     VARCHAR2(50),
    ARCHIVE_LOCATION_FILE_ID               VARCHAR2(2700),
    DESTINATION_LOCATION_FILE_CONTAINER_ID VARCHAR2(50),
    DESTINATION_LOCATION_FILE_ID           VARCHAR2(2700),
    COMPLETION_EVENT                       CHAR,
    PERCENT_COMPLETE                       NUMBER(10),
    DATA_SIZE                              NUMBER(19),
    CREATED                                TIMESTAMP(6),
    DESTINATION_TYPE                       VARCHAR2(50),
    S3_ACCOUNT_ACCESS_KEY                  BLOB,
    S3_ACCOUNT_SECRET_KEY                  BLOB,
    S3_ACCOUNT_REGION                      VARCHAR2(50),
    PRIORITY                               NUMBER(10) default 100,
    S3_ARCHIVE_CONFIGURATION_ID            VARCHAR2(50),
    PROCESSED                              TIMESTAMP(6),
    GOOGLE_DRIVE_ACCESS_TOKEN              BLOB,
    IN_PROCESS                             CHAR       default '0' not null
);

comment on table "HPC_DATA_OBJECT_DOWNLOAD_TASK" is 'Active data object download tasks';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."ID" is 'The download task ID';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."USER_ID" is 'The user ID who submitted the download request';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."CONFIGURATION_ID" is 'The configuration ID to use in downloading the data object';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DATA_TRANSFER_REQUEST_ID" is 'The data transfer (S3 or Globus) request ID that is currently in progress';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DATA_TRANSFER_TYPE" is 'The data transfer (S3 or Globus) that is currently in progress';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DATA_TRANSFER_STATUS" is 'The data transfer status (S3 or Globus)';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DOWNLOAD_FILE_PATH" is 'The file path used in the 2-hop download';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."ARCHIVE_LOCATION_FILE_CONTAINER_ID" is 'The archive location container ID of the data object to be downloaded';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."ARCHIVE_LOCATION_FILE_ID" is 'The archive location file ID of the data object to be downloaded';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DESTINATION_LOCATION_FILE_CONTAINER_ID" is 'The download destination container ID';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DESTINATION_LOCATION_FILE_ID" is 'The download destination file ID';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."COMPLETION_EVENT" is 'An indicator whether a completion event needs to be generated when the task is completed';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."PERCENT_COMPLETE" is 'The download task completion %';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DATA_SIZE" is 'The data object size';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."CREATED" is 'The date and time the task was created';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."DESTINATION_TYPE" is 'The download destination type - either Globus or S3';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."S3_ACCOUNT_ACCESS_KEY" is 'The S3 destination account access key';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."S3_ACCOUNT_SECRET_KEY" is 'The S3 destination account secret key';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."S3_ACCOUNT_REGION" is 'The S3 destination account region';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."PRIORITY" is 'The download task priority';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."S3_ARCHIVE_CONFIGURATION_ID" is 'The S3 Archive configuration ID to use if downloading from S3 Archive';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."PROCESSED" is 'The date and time the task was processed';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."GOOGLE_DRIVE_ACCESS_TOKEN" is 'The Google Drive Access Token';
comment on column "HPC_DATA_OBJECT_DOWNLOAD_TASK"."IN_PROCESS" is 'An indicator whether this task is in-process, i.e. a thread is working on submitting it';


CREATE TABLE "IRODS"."HPC_DATA_OBJECT_REGISTRATION_RESULT"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   PATH VARCHAR2(2700) NOT NULL,
   USER_ID VARCHAR2(50) NOT NULL,
   UPLOAD_METHOD VARCHAR2(50),
   RESULT char(1) NOT NULL,
   MESSAGE VARCHAR2(4000),
   EFFECTIVE_TRANSFER_SPEED number(10),
   DATA_TRANSFER_REQUEST_ID VARCHAR(50),
   SOURCE_LOCATION_FILE_ID VARCHAR2(2700),
   SOURCE_LOCATION_FILE_CONTAINER_ID VARCHAR2(50),
   SOURCE_LOCATION_FILE_CONTAINER_NAME VARCHAR2(250),
   CREATED timestamp NOT NULL,
   COMPLETED timestamp NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_DOWNLOAD_TASK_RESULT"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   USER_ID VARCHAR2(50) NOT NULL,
   TYPE VARCHAR2(50) NOT NULL,
   PATH VARCHAR2(2700),
   DATA_TRANSFER_REQUEST_ID VARCHAR2(50),
   DATA_TRANSFER_TYPE VARCHAR2(50),
   DESTINATION_LOCATION_FILE_CONTAINER_ID VARCHAR2(50) NOT NULL,
   DESTINATION_LOCATION_FILE_ID VARCHAR2(2700),
   RESULT VARCHAR2(50) NOT NULL,
   MESSAGE VARCHAR2(4000),
   ITEMS CLOB,
   CREATED timestamp NOT NULL,
   COMPLETED timestamp NOT NULL,
   COMPLETION_EVENT char(1),
   EFFECTIVE_TRANSFER_SPEED number(10),
   DESTINATION_TYPE VARCHAR2(50),
   DATA_SIZE number(19),
   DESTINATION_LOCATION_FILE_CONTAINER_NAME VARCHAR2(250)
)
;

CREATE TABLE "IRODS"."HPC_EVENT"
(
   ID number(10) default "IRODS"."HPC_EVENT_ID_seq"."NEXTVAL" PRIMARY KEY NOT NULL,
   USER_IDS VARCHAR2(4000) NOT NULL,
   TYPE VARCHAR2(50) NOT NULL,
   PAYLOAD blob,
   CREATED timestamp NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_EVENT_HISTORY"
(
   ID number(10) PRIMARY KEY NOT NULL,
   USER_IDS VARCHAR2(4000) NOT NULL,
   TYPE VARCHAR2(50) NOT NULL,
   PAYLOAD blob,
   CREATED timestamp NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_GROUP"
(
    GROUP_NAME        VARCHAR2(250) not null
        constraint "HPC_GROUP_pkey"
            primary key,
    CREATED           TIMESTAMP(6),
    LAST_UPDATED      TIMESTAMP(6),
    DOC               VARCHAR2(50),
    ACTIVE            CHAR,
    ACTIVE_UPDATED_BY VARCHAR2(250)
)
;

CREATE TABLE "IRODS"."HPC_NOTIFICATION_DELIVERY_RECEIPT"
(
   EVENT_ID number(10) NOT NULL,
   USER_ID VARCHAR2(50) NOT NULL,
   NOTIFICATION_DELIVERY_METHOD VARCHAR2(50) NOT NULL,
   DELIVERY_STATUS char(1) NOT NULL,
   DELIVERED timestamp NOT NULL,
   CONSTRAINT HPC_NOTIFICATION_DELIVERY_RECEIPT_pkey PRIMARY KEY (EVENT_ID,USER_ID,NOTIFICATION_DELIVERY_METHOD)
)
;


CREATE TABLE "IRODS"."HPC_NOTIFICATION_SUBSCRIPTION"
(
    ID number(10) default "IRODS"."HPC_NOTIFICATION_SUBSCRIPTION_ID_seq".NEXTVAL PRIMARY KEY NOT NULL,
    USER_ID VARCHAR2(50) NOT NULL,
    EVENT_TYPE VARCHAR2(50) NOT NULL,
    NOTIFICATION_DELIVERY_METHODS VARCHAR(250) NOT NULL
)
;

CREATE UNIQUE INDEX HPC_NOTIFICATION_SUBSCRIPTION_unique ON "IRODS"."HPC_NOTIFICATION_SUBSCRIPTION"
(
  USER_ID,
  EVENT_TYPE
)
;
CREATE TABLE "IRODS"."HPC_NOTIFICATION_TRIGGER"
(
   NOTIFICATION_SUBSCRIPTION_ID number(10),
   NOTIFICATION_TRIGGER VARCHAR(2700)
)
;
ALTER TABLE "IRODS"."HPC_NOTIFICATION_TRIGGER"
ADD CONSTRAINT HPC_NOTIFICATION_TRIGGER_NOTIFICATION_SUBSCRIPTION_ID_fkey
FOREIGN KEY (NOTIFICATION_SUBSCRIPTION_ID)
REFERENCES "IRODS"."HPC_NOTIFICATION_SUBSCRIPTION"(ID) ON DELETE CASCADE
;

CREATE TABLE "IRODS"."HPC_S3_ARCHIVE_CONFIGURATION"
(
   ID VARCHAR2(50) PRIMARY KEY NOT NULL,
   PROVIDER VARCHAR2(50) NOT NULL,
   DATA_MANAGEMENT_CONFIGURATION_ID VARCHAR2(50) NOT NULL,
   URL_OR_REGION VARCHAR2(50) NOT NULL,
   BUCKET VARCHAR2(250) NOT NULL,
   OBJECT_ID VARCHAR2(50) NOT NULL,
   UPLOAD_REQUEST_URL_EXPIRATION number(10) NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_SYSTEM_ACCOUNT"
(
   ID number(10) default "IRODS"."HPC_SYSTEM_ACCOUNT_SEQ".NEXTVAL PRIMARY KEY NOT NULL,
   SYSTEM VARCHAR2(50) NOT NULL,
   CLASSIFIER VARCHAR2(50),
   DATA_TRANSFER_TYPE VARCHAR2(50),
   USERNAME VARCHAR2(250) NOT NULL,
   PASSWORD blob NOT NULL
)
;

CREATE TABLE "IRODS"."HPC_USER"
(
   USER_ID VARCHAR(50) PRIMARY KEY NOT NULL,
   FIRST_NAME VARCHAR2(250),
   LAST_NAME VARCHAR2(250),
   CREATED date,
   LAST_UPDATED date,
   DOC VARCHAR2(50),
   ACTIVE char(1),
   ACTIVE_UPDATED_BY VARCHAR2(250),
   DEFAULT_CONFIGURATION_ID VARCHAR2(50)
)
;

CREATE TABLE "IRODS"."HPC_USER_BOOKMARK"
(
   USER_ID VARCHAR2(50) NOT NULL,
   BOOKMARK_NAME VARCHAR2(250) NOT NULL,
   BOOKMARK_GROUP VARCHAR2(250),
   PATH VARCHAR2(2700) NOT NULL,
   CREATED timestamp NOT NULL,
   UPDATED timestamp NOT NULL,
   CONSTRAINT HPC_USER_BOOKMARK_pkey PRIMARY KEY (USER_ID,BOOKMARK_NAME)
)
;
comment on table "HPC_USER_BOOKMARK" is 'User bookmarks';
comment on column "HPC_USER_BOOKMARK"."USER_ID" is 'The user ID that owns this bookmark';
comment on column "HPC_USER_BOOKMARK"."BOOKMARK_NAME" is 'The bookmark name';
comment on column "HPC_USER_BOOKMARK"."BOOKMARK_GROUP" is 'The bookmark group';
comment on column "HPC_USER_BOOKMARK"."PATH" is 'The bookmark path';
comment on column "HPC_USER_BOOKMARK"."CREATED" is 'The date / time the bookmark was created';
comment on column "HPC_USER_BOOKMARK"."UPDATED" is 'The date / time the bookmark was updated';


CREATE TABLE "IRODS"."HPC_USER_QUERY"
(
   USER_ID VARCHAR2(50) NOT NULL,
   QUERY_NAME VARCHAR2(250) NOT NULL,
   QUERY blob NOT NULL,
   DETAILED_RESPONSE char(1) NOT NULL,
   TOTAL_COUNT char(1) NOT NULL,
   QUERY_TYPE VARCHAR2(50) NOT NULL,
   CREATED timestamp NOT NULL,
   UPDATED timestamp NOT NULL,
   CONSTRAINT HPC_USER_QUERY_pkey PRIMARY KEY (USER_ID,QUERY_NAME)
)
;

